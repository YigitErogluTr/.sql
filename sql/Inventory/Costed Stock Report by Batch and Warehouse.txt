SELECT      T2.ItemCode AS "Kalem Kodu",      OITM.ItemName AS "Kalem Tanımı",       T2.LocCode AS "Depo",      T4.DistNumber AS "Parti Numarası",      SUM(T3.Quantity) AS "Stok",      CASE          WHEN T4.Quantity > 0 THEN T4.CostTotal / T4.Quantity          ELSE 0      END AS "Maliyet",     SUM(T3.Quantity) *          (CASE              WHEN T4.Quantity > 0 THEN T4.CostTotal / T4.Quantity              ELSE 0          END) AS "Toplam Maliyet",     OITB.ItmsGrpNam AS "Malzeme Grubu",     OITM.InvntryUom AS "Stok Takip Birimi",     OITM.ItmsGrpCod FROM      OITL T2 WITH (NOLOCK) LEFT OUTER JOIN      ITL1 T3 WITH (NOLOCK) ON T2.LogEntry = T3.LogEntry AND T2.ItemCode = T3.ItemCode LEFT OUTER JOIN      OBTN T4 WITH (NOLOCK) ON T3.ItemCode = T4.ItemCode AND T3.SysNumber = T4.SysNumber LEFT OUTER JOIN      OITM ON T2.ItemCode = OITM.ItemCode LEFT OUTER JOIN      OITB ON OITM.ItmsGrpCod = OITB.ItmsGrpCod WHERE      COALESCE(T4.DistNumber, '') != '' GROUP BY      T2.ItemCode, T2.LocCode, T4.DistNumber, T4.CostTotal, T4.Quantity,      OITM.ItemName, OITM.ItmsGrpCod, OITB.ItmsGrpNam, OITM.InvntryUom HAVING      SUM(T3.Quantity) > 0  ORDER BY        T2.ItemCode, T2.LocCode, T4.DistNumber