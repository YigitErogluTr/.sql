SELECT T2.ItemCode [Kalem Kodu], T6.ItmsGrpNam [Kalem Grubu],  T4.DistNumber [Kalem Tanımı],   --SUM(T3.Quantity) [Parti Bakiyesi], REPLACE(CAST(SUM(T3.Quantity) AS nvarchar(30)),'.',',') [Parti Bakiyesi],  SUM(T3.Quantity)* (CASE WHEN T4.Quantity<>0 THEN T4.CostTotal/T4.Quantity ELSE 0 END) [Parti Envanter Değeri], T4.InDate [Parti Üretim Tarihi],  --(CASE WHEN T4.Quantity<>0 THEN T4.CostTotal/T4.Quantity ELSE 0 END) [Birim Fiyat], REPLACE(CAST((CASE WHEN T4.Quantity<>0 THEN T4.CostTotal/T4.Quantity ELSE 0 END) AS nvarchar(30)),'.',',') [Birim Fiyat],  T4.CostTotal [Parti Toplam Maliyeti], T4.Quantity [Parti Toplam Giriş Miktarı],T5.ItemName [Kalem Tanımı],  T2.LocCode AS [Depo Kodu] FROM OITL T2 WITH (NOLOCK)  LEFT OUTER JOIN ITL1 T3 WITH (NOLOCK) ON T2.LogEntry=T3.LogEntry AND T2.ItemCode=T3.ItemCode  LEFT OUTER JOIN OBTN T4 WITH (NOLOCK) ON T3.ItemCode=T4.ItemCode AND T3.SysNumber=T4.SysNumber  LEFT OUTER JOIN OITM T5 WITH (NOLOCK) ON T2.ItemCode=T5.ItemCode LEFT OUTER JOIN OITB T6 WITH (NOLOCK) ON T5.ItmsGrpCod=T6.ItmsGrpCod WHERE T2.DocDate BETWEEN [%0] AND [%1] AND ISNULL(T4.DistNumber,'')!=''  GROUP BY T4.InDate,T4.DistNumber,T4.CostTotal,T4.Quantity,T2.ItemCode,T5.ItemName,T6.ItmsGrpNam,T2.LocCode ORDER BY 2, 1