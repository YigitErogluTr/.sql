/* SELECT * FROM OJDT T0 */  DECLARE @BASTAR DATE DECLARE @BITTAR DATE  SET @BASTAR = /* T0.RefDate */ '[%0]' SET @BITTAR = /* T0.RefDate */ '[%1]'  --SET @BASTAR = '2023-01-01' --SET @BITTAR = '2023-01-31'  SELECT  B.Account, C.AcctName, B.ProfitCode, T4.OcrName, SUM(B.Debit) Debit, SUM(B.Credit) Credit, SUM(B.Debit) - SUM(B.Credit) Bakiye, C.U_SNT_StandartMaliyetKarsiHesabi StandartMaliyetKarsiHesabi,  (SELECT SUM(X.Debit) - SUM(X.Credit) FROM JDT1 X WITH(NOLOCK) WHERE X.RefDate BETWEEN @BASTAR  AND @BITTAR AND X.Account=C.U_SNT_StandartMaliyetKarsiHesabi) Bakiye_StandartMaliyetKarsiHesabi, C.U_SNT_StandartMaliyetYediliKarsiHesaplar, (SELECT SUM(X.Debit) - SUM(X.Credit) FROM JDT1 X WITH(NOLOCK) WHERE X.RefDate BETWEEN @BASTAR  AND @BITTAR AND X.Account=C.U_SNT_StandartMaliyetYediliKarsiHesaplar) Bakiye_YediliKarsiHesaplar  FROM OJDT A WITH(NOLOCK) INNER JOIN JDT1 B WITH(NOLOCK) ON A.TransId=B.TransId INNER JOIN OACT C WITH(NOLOCK) ON B.Account=C.AcctCode LEFT OUTER JOIN OACT T1 WITH(NOLOCK) ON C.U_SNT_StandartMaliyetKarsiHesabi=T1.AcctCode LEFT OUTER JOIN OACT T2 WITH(NOLOCK) ON C.U_SNT_StandartMaliyetYediliKarsiHesaplar=T2.AcctCode LEFT OUTER JOIN OACT T3 WITH(NOLOCK) ON C.FatherNum=T3.AcctCode LEFT OUTER JOIN OOCR T4 WITH(NOLOCK) ON B.ProfitCode=T4.OcrCode AND T4.DimCode=1 WHERE B.Account LIKE '373%' AND A.RefDate BETWEEN @BASTAR  AND @BITTAR AND A.TransType NOT IN (60) GROUP BY B.Account, C.AcctName, C.U_SNT_StandartMaliyetKarsiHesabi, C.U_SNT_StandartMaliyetYediliKarsiHesaplar, B.ProfitCode, T4.OcrName ORDER BY 1 --AND A.TransType IN (1470000071)  FOR BROWSE