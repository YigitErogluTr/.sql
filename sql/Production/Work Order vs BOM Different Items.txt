SELECT      W.DocNum AS [Üretim Sipariş No],     W.PostDate,     YEAR(W.PostDate) AS [Yıl],     W.ItemCode AS [Ana Ürün Kodu],     OI1.ItemName AS [Ana Ürün Adı],     W.Uom,     B.CompCode AS [BOM Bileşen Kodu],     OI2.ItemName AS [BOM Bileşen Adı],      OC.OcrName AS [Üretim Bölümü Adı] FROM OWOR W INNER JOIN OITM OI1 ON W.ItemCode = OI1.ItemCode INNER JOIN OITB G1 ON OI1.ItmsGrpCod = G1.ItmsGrpCod      AND G1.ItmsGrpCod IN (100,101,102,103,104,105,106,107,111) LEFT JOIN OOCR OC ON OI1.U_H1_UretimBolumu = OC.OcrCode INNER JOIN (     SELECT          T1.Father AS FatherCode,         T1.Code AS CompCode     FROM ITT1 T1     INNER JOIN OITT T0 ON T0.Code = T1.Father ) B ON B.FatherCode = W.ItemCode INNER JOIN OITM OI2 ON B.CompCode = OI2.ItemCode INNER JOIN OITB G2 ON OI2.ItmsGrpCod = G2.ItmsGrpCod      AND G2.ItmsGrpCod IN (100,101,102,103,104,105,106,107,111) LEFT JOIN WOR1 WO ON WO.DocEntry = W.DocEntry AND WO.ItemCode = B.CompCode WHERE WO.ItemCode IS NULL  UNION ALL  -- Siparişte olup BOM'da olmayanlar SELECT      W.DocNum AS [Üretim Sipariş No],     W.PostDate,     YEAR(W.PostDate) AS [Yıl],     W.ItemCode AS [Ana Ürün Kodu],     OI1.ItemName AS [Ana Ürün Adı],     W.Uom,     WO.ItemCode AS [BOM Bileşen Kodu],     OI2.ItemName AS [BOM Bileşen Adı],     OC.OcrName AS [Üretim Bölümü Adı] FROM OWOR W INNER JOIN OITM OI1 ON W.ItemCode = OI1.ItemCode INNER JOIN OITB G1 ON OI1.ItmsGrpCod = G1.ItmsGrpCod      AND G1.ItmsGrpCod IN (100,101,102,103,104,105,106,107,111) LEFT JOIN OOCR OC ON OI1.U_H1_UretimBolumu = OC.OcrCode INNER JOIN WOR1 WO ON WO.DocEntry = W.DocEntry INNER JOIN OITM OI2 ON WO.ItemCode = OI2.ItemCode INNER JOIN OITB G2 ON OI2.ItmsGrpCod = G2.ItmsGrpCod      AND G2.ItmsGrpCod IN (100,101,102,103,104,105,106,107,111) LEFT JOIN ITT1 T1 ON T1.Father = W.ItemCode AND T1.Code = WO.ItemCode WHERE T1.Code IS NULL ORDER BY [Üretim Sipariş No], [Ana Ürün Kodu], [BOM Bileşen Kodu];