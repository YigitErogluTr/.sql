SELECT      a.*,     a.U_fasonuretim,     b.ItemCode,      b.ResName FROM (     SELECT          T0.DocNum,         CASE T0.Type             WHEN 'S' THEN 'Standart'                   WHEN 'D' THEN 'Demontaj'              WHEN 'P' THEN 'Özel'                   ELSE T0.Type         END AS 'Type',         CASE T0.Status             WHEN 'L' THEN 'Kapalı'             WHEN 'C' THEN 'İptal'             WHEN 'R' THEN 'Onaylandı'             WHEN 'P' THEN 'Planlandı'             ELSE T0.Status         END AS 'Status',         T0.DueDate,         MONTH(T0.DueDate) AS 'Vade Tarihi Ayı',         T0.StartDate,         MONTH(T0.StartDate) AS 'Başlangıç Tarihi Ayı',         T0.PostDate,         MONTH(T0.PostDate) AS 'Sipariş Tarihi Ayı',         CASE              WHEN T0.CloseDate IS NOT NULL THEN CONVERT(VARCHAR, T0.CloseDate,103)             ELSE 'Belge Durumu Açık'          END AS 'CloseDate',             CASE              WHEN T0.CloseDate IS NOT NULL THEN CONVERT(VARCHAR, MONTH(T0.CloseDate))             ELSE 'Belge Durumu Açık'         END AS 'Kapanış Tarihi Ayı',           T0.CardCode,         OCRD.CardName,         CASE              WHEN T0.LinkToObj = 202 THEN 'Üretim Siparişi'             WHEN T0.LinkToObj = 17 THEN 'Satış Siparişi'             ELSE NULL         END AS 'Bağlantılı Sipariş Türü',         T0.OriginNum AS "Bağlantılı Sipariş Numarası",         T0.U_fasonuretim,         OITB.ItmsGrpNam,          T0.ItemCode,         OITM.U_stokkodgrup,         T0.CmpltQty,         T0.[Uom] AS [Birim],         T0.Comments,         OITM.U_H1_UretimBolumu,         OPRC.PrcName,          OITM.U_urungrup AS "Urun Grubu"     FROM          dbo.OWOR T0     LEFT JOIN          dbo.OITM ON T0.ItemCode = OITM.ItemCode      LEFT JOIN          OPRC ON OITM.U_H1_UretimBolumu = OPRC.PrcCode     LEFT JOIN         dbo.OITB ON OITM.ItmsGrpCod = OITB.ItmsGrpCod     LEFT JOIN         OCRD ON T0.CardCode = OCRD.CardCode ) a INNER JOIN (     SELECT          OWOR.DocNum,         WOR1.ItemCode,         ORSC.ResName     FROM          OWOR     LEFT JOIN          WOR1 ON OWOR.DocEntry = WOR1.DocEntry     LEFT JOIN          ORSC ON WOR1.ItemCode = ORSC.VisResCode ) b ON a.DocNum = b.DocNum ORDER BY          a.DocNum ASC