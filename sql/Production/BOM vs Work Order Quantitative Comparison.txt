SELECT     W.DocNum                          AS [İş Emri No],     W.ItemCode                        AS [Üretilen Ürün Kodu],     W.PlannedQty                      AS [Planlanan Üretim],      ISNULL(WR.ItemCode, I1.Code)      AS [Malzeme Kodu],     ISNULL(M.ItemName, MI.ItemName)   AS [Malzeme Adı],     ISNULL(G1.ItmsGrpNam, G2.ItmsGrpNam) AS [Malzeme Grubu],      -- Ürün Ağacı (BOM) Teorik Tüketim     ISNULL(I1.Quantity,0) * ISNULL(W.PlannedQty,0) AS [Teorik Tüketim],      -- İş Emri Planlanan     ISNULL(WR.PlannedQty,0) AS [Planlanan Tüketim],      -- İş Emri Fiili     ISNULL(WR.IssuedQty,0)  AS [Fiili Tüketim],      -- Sapma     (ISNULL(WR.IssuedQty,0) - (ISNULL(I1.Quantity,0) * ISNULL(W.PlannedQty,0))) AS [Sapma],      CASE          WHEN ISNULL(I1.Quantity,0) * ISNULL(W.PlannedQty,0) = 0 THEN NULL         ELSE ROUND(ISNULL(WR.IssuedQty,0) / (I1.Quantity * W.PlannedQty) * 100, 2)     END AS ['% Gerçekleşme'],      CASE          WHEN WR.ItemCode IS NULL AND I1.Code IS NOT NULL THEN 'Sadece Ürün Ağacında'         WHEN WR.ItemCode IS NOT NULL AND I1.Code IS NULL THEN 'Sadece İş Emrinde'         ELSE 'Her İkisinde Var'     END AS [Durum]  FROM OWOR W LEFT JOIN WOR1 WR ON W.DocEntry = WR.DocEntry FULL OUTER JOIN ITT1 I1         ON W.ItemCode = I1.Father        AND WR.ItemCode = I1.Code LEFT JOIN OITM M  ON WR.ItemCode = M.ItemCode LEFT JOIN OITM MI ON I1.Code     = MI.ItemCode LEFT JOIN OITB G1 ON M.ItmsGrpCod  = G1.ItmsGrpCod LEFT JOIN OITB G2 ON MI.ItmsGrpCod = G2.ItmsGrpCod WHERE ISNULL(W.Status,'') <> 'C'   AND ISNULL(G1.ItmsGrpCod, G2.ItmsGrpCod) IN (100,101,102,103,104,105,106,107,111) ORDER BY W.DocNum, [Malzeme Kodu]