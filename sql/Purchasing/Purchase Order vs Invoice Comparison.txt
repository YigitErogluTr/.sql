SELECT      PO.DocEntry AS SiparisNo,     POL.ItemCode,     OITM.ItemName,     POL.Quantity AS SiparisMiktari,     POL.Price AS SiparisBirimFiyat,     PO.DocCur AS SiparisParaBirimi,     PO.DocRate AS SiparisKur,     POL.UomCode AS SiparisOlcuBirimi,      -- İrsaliye varsa göster, yoksa NULL     PDN.DocEntry AS IrsaliyeNo,       -- Fatura bilgisi (Doğrudan veya İrsaliye üzerinden olsun)     COALESCE(PCH_MG.DocEntry, PCH_DOGRU.DocEntry) AS FaturaNo,     COALESCE(PCHL_MG.Quantity, PCHL_DOGRU.Quantity) AS FaturaMiktari,     COALESCE(PCHL_MG.Price, PCHL_DOGRU.Price) AS FaturaBirimFiyat,     COALESCE(PCH_MG.DocCur, PCH_DOGRU.DocCur) AS FaturaPB,     COALESCE(PCH_MG.DocRate, PCH_DOGRU.DocRate) AS FaturaKur,     COALESCE(PCHL_MG.UomCode, PCHL_DOGRU.UomCode) AS FaturaOlcuBirimi,      OITM.InvntryUom AS StokOlcuBirimi  FROM      OPOR PO     INNER JOIN POR1 POL ON PO.DocEntry = POL.DocEntry     LEFT JOIN OITM ON POL.ItemCode = OITM.ItemCode      -- MAL GİRİŞİ (irsaliye varsa sadece numarasını alıyoruz)     LEFT JOIN PDN1 PDNL ON POL.DocEntry = PDNL.BaseEntry                          AND POL.LineNum = PDNL.BaseLine                          AND PDNL.BaseType = 22     LEFT JOIN OPDN PDN ON PDNL.DocEntry = PDN.DocEntry      -- FATURA: Mal girişi üzerinden kesilen     LEFT JOIN PCH1 PCHL_MG ON PDNL.DocEntry = PCHL_MG.BaseEntry                             AND PDNL.LineNum = PCHL_MG.BaseLine                             AND PCHL_MG.BaseType = 20     LEFT JOIN OPCH PCH_MG ON PCHL_MG.DocEntry = PCH_MG.DocEntry      -- FATURA: Doğrudan siparişten kesilen     LEFT JOIN PCH1 PCHL_DOGRU ON POL.DocEntry = PCHL_DOGRU.BaseEntry                                AND POL.LineNum = PCHL_DOGRU.BaseLine                                AND PCHL_DOGRU.BaseType = 22     LEFT JOIN OPCH PCH_DOGRU ON PCHL_DOGRU.DocEntry = PCH_DOGRU.DocEntry  ORDER BY PO.DocEntry, POL.LineNum