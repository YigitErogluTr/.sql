SELECT      T1.ItemCode AS [Ürün Kodu],     T1.Dscription AS [Ürün Adı],     T0.CardName AS [Tedarikçi Adı],     T1.Quantity AS [İrsaliye Miktar],     T1.UomCode as 'İrsaliye Birim',     T1.Price AS [İrsaliye Birim Fiyat],     T1.InvQty as 'Stok Miktar',     T1.UomCode2 as 'Stok Birim',      FORMAT(         CAST(              CAST(T1.Quantity AS DECIMAL(38,8)) *              CAST(T1.Price AS DECIMAL(38,8)) *              CAST(CASE WHEN T1.Currency = 'TRY' THEN 1 ELSE T1.Rate END AS DECIMAL(38,8)) /              NULLIF(CAST(T1.InvQty AS DECIMAL(38,8)), 0)         AS DECIMAL(38,8)),         'N8',         'tr-TR'     ) AS [Stok Birim Fiyatı],      T1.Currency,     T1.Rate,     T0.DocDate AS [SAS Mal Giriş Tarihi],     T0.DocEntry as [SAS Mal Giriş],      CASE          WHEN T1.BaseType = 22 THEN 'Satınalma Siparişi'          ELSE CAST(T1.BaseType AS VARCHAR)      END AS [Temel Belge Türü],      T1.[BaseEntry] as [Temel Belge],     T2.[U_NAME] AS [Mal Girişi Oluşturan],     T3.U_NAME AS [Temel Belge Oluşturan],          CASE          WHEN T1.TargetType = 18 THEN 'Satıcı Faturası'          WHEN T1.TargetType = 21 THEN 'Mal İadesi'          WHEN T1.TargetType = 234000032 THEN 'Mal İadesi Talebi'          ELSE CAST(T1.TargetType AS VARCHAR)      END AS [Hedef Belge Türü],      T1.TrgetEntry,     T_INV.NumAtCard AS [Satıcı Fatura No]  FROM      OPDN T0 INNER JOIN      PDN1 T1 ON T0.DocEntry = T1.DocEntry INNER JOIN      OUSR T2 ON T0.[UserSign] = T2.[USERID] LEFT JOIN      OPOR T_Base ON T1.BaseType = 22 AND T1.BaseEntry = T_Base.DocEntry LEFT JOIN      OUSR T3 ON T_Base.UserSign = T3.USERID LEFT JOIN  OPCH T_INV ON T1.TargetType = 18 AND T1.TrgetEntry = T_INV.DocEntry WHERE      T0.CANCELED = 'N' ORDER BY      T0.DocDate DESC